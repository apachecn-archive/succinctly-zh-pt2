# 十七、对象参考

本章包含了一些可以用来与 Visual Studio 交互的基本对象类的摘要。

## 应用对象(DTE2)

应用对象(通常存储在变量 **_applicationObject** 中)是 Visual Studio IDE 中所有内容的封装。

| 财产 | 数据类型 | 描述 |
| 活动文档 | 文件 | 当前活动文档。 |
| 活动解决方案项目 | 项目集合 | 当前解决方案中所有项目的集合。 |
| 活动窗口 | 窗户 | 当前活动或最上面的窗口。 |
| -再见 | 收藏品 | 所有可用附加程序的集合。 |
| 命令栏 | 指令杠 | 访问 Visual Studio 命令和菜单。 |
| CommandLineArgument | 线 | 启动 Visual Studio 时传递给它的命令行参数。 |
| 调试器 | 调试器 | 对 Visual Studio 调试器对象的访问。 |
| 显示模式 | 列举型别 | DisplayMDI 或 DisplayMDITabs。 |
| 文档 | 收藏品 | 集成开发环境中打开文档的集合。 |
| 版本 | 线 | 终极版、高级版、专业版或快速版。 |
| 表 | 线 | 完整路径和文件名。 |
| ItemOperations | 目标 | 允许在 Visual Studio 中操作文件。 |
| 本地誓言 | 整数 | 地理区域，1033-美国等。 |
| MainWindow(主窗口) | 窗户 | 开发环境的主窗口。 |
| 方式 | 列举型别 | 集成开发环境模式设计或集成开发环境模式调试。 |
| RegistryRoot | 线 | 存储设置的注册表中的根键。 |
| 解决办法 | 解决办法 | 当前解决方案对象。 |
| 工具窗口 | 工具窗口 | IDE 工具窗口的快捷访问对象。 |
| 版本 | 线 | 10.0、12.0 等。 |
| Windows 操作系统 | 收藏品 | 所有打开的 IDE 窗口的集合。 |

## 窗口和文档

窗口表示 Visual Studio 使用的工具窗口或编辑表单。工具窗口包括**解决方案资源管理器**、**属性**、**工具箱**等。文档窗口是编辑窗口，包含表示用户正在编辑的源代码的文档对象。详见[第 9 章](09.html#_Chapter_9_)和[第 10 章](10.html#_Chapter_10_)举例说明。

### 文件

| 财产 | 数据类型 | 描述 |
| 活动窗口 | 窗户 | 文档打开的窗口。 |
| 表 | 线 | 文档中文件的完整路径和文件名。 |
| 种类 | 线 | 指示文档类型的 GUID 字符串。 |
| 名字 | 线 | 文档的名称。 |
| 小路 | 线 | 完整路径，不带文件名。 |
| ProjectItem | ProjectItem | 项目中与文档关联的项。 |
| 获救的 | 布尔代数学体系的 | 如果文档自上次打开后未被修改，则为 True。 |
| 选择 | 选择 | 文档中的当前选择文本。 |
| **方法** |
| 使活动 | 将焦点移到文档。 |
| 关闭 | 关闭并选择性地保存文档。 |
| NewWindow(新建窗口) | 创建一个新窗口来查看文档。 |
| 目标 | 与文档关联的运行时对象。 |
| 重做 | 重新执行上次撤消的操作。 |
| 救援 | 将文档保存到磁盘。 |
| 取消 | 撤消对文档执行的最后一个操作。 |

### 窗口

该窗口代表工具窗口或包含正在编辑的文本的文档窗口。

| 财产 | 数据类型 | 描述 |
| 自动隐藏 | 布尔代数学体系的 | 工具窗口可以隐藏吗？ |
| 标题 | 线 | 窗口标题。 |
| 文件 | 文件 | 窗口中的文档(如果存在)。 |
| 高度 | 整数 | 窗口的高度，以像素为单位。 |
| 种类 | 线 | “工具”或“文档”。 |
| 左边的 | 整数 | 与容器左边缘的距离，以像素为单位。 |
| 目标 | 目标 | 允许运行时访问窗口中的内容，大部分对象(“文本文档”)。 |
| ObjectKind | 线 | 表示窗口中包含的工具的 GUID。 |
| 项目 | 项目 | 与窗口关联的项目。 |
| ProjectItem | ProjectItem | 与窗口关联的项目元素。 |
| 选择 | 选择对象 | 窗口中当前选定的文本。 |
| 顶端 | 整数 | 到容器顶部边缘的距离，以像素为单位。 |
| 看得见的 | 布尔代数学体系的 | 窗口当前可见吗？ |
| 宽度 | 整数 | 窗口宽度，以像素为单位。 |
| WindowState | 列举型别 | vsWindowStateNormal、StateMinimize 或 StateMaximize。 |
| **方法** |
| 使活动 | 将焦点移到窗口。 |
| 关闭 | 关闭并选择性地保存文档。 |
| SetTabPicture | 为工具窗口设置要显示的图片。 |

## 解决方案和项目

解决方案对象表示一个解决方案及其组件项目，您可以轻松地对其进行操作。详见[第 8 章](08.html#_Chapter_8_)和[第 9 章](09.html#_Chapter_9_)。

### 溶液

下表列出了 _applicationObject 的解决方案属性。

| 财产 | 数据类型 | 描述 |
| -再见 | 收藏品 | 与解决方案关联的附加程序对象的集合。 |
| 表 | 线 | 解决方案的路径和文件名。 |
| 全球 | 收藏品 | 与解决方案一起保存的全局变量。 |
| is ogen . is ogen | 布尔代数学体系的 | 解决方案开放吗？ |
| 项目 | 收藏品 | 解决方案中所有项目的集合。 |
| 性能 | 收藏品 | 所有解决方案属性的名称和值。 |
| 获救的 | 布尔代数学体系的 | 解决方案是否已保存？ |
| 解决方案构建 | 解决方案构建 | 具有解决方案的生成信息的对象。 |
| TemplatePath | 字符串对象 | 项目类型的模板路径，即 C#，VB。 |
| **方法** |
| AddFromFile | 将现有文件添加到项目中。 |
| 添加自模板 | 复制模板文件并将其添加到解决方案中。 |
| 关闭 | 关闭解决方案。 |
| 创造 | 创建一个空解决方案。 |
| FindProjectItem | 在项目中查找项目。 |
| 项目 | 在解决方案中获得一个项目。 |
| 打开 | 打开解决方案。 |
| 项目模板路径 | 特定项目类型的项目项模板的返回位置。 |
| 去除 | 从解决方案中删除指定的项目。 |
| 保存为 | 用另一个名称保存解决方案。 |

### 项目

您可以迭代解决方案的项目集合，以获取解决方案空间中任何给定项目的详细信息。

| 财产 | 数据类型 | 描述 |
| CodeModel | 目标 | 代码模型(对源元素的访问)。 |
| 表 | 线 | 项目的完整路径和文件名。 |
| 全球 | 收藏品 | 与项目关联的全局附加程序值。 |
| 种类 | 图形用户界面字符串 | 解决方案的类型，比如 VB 或者 C#。 |
| 名字 | 线 | 简短的项目名称。 |
| ProjectItems | 收藏品 | 构成项目的项目集合。 |
| 性能 | 收藏品 | 与项目关联的属性。 |
| 获救的 | 布尔代数学体系的 | 项目是否已保存？ |
| 唯一名称 | 线 | 项目的唯一名称。 |
| **方法** |
| 救援 | 保存项目或项目项。 |
| 保存为 | 另存为新文件名。 |

### 项目项

项目项是文件(源文件、XML 文件等)。)组成了这个项目。

| 财产 | 数据类型 | 描述 |
| 包含项目 | 项目 | 承载项目项或文件的项目。 |
| 文件 | 目标 | 文件的文档对象(如果存在)。 |
| 文件代码模型 | 代码模型 | 允许您访问源文件中的高级代码元素。 |
| 文件计数 | 整数 | 与项目项关联的文件数。 |
| 文件名 | 收藏品 | 与项目关联的文件名。 |
| is ogen . is ogen | 布尔代数学体系的 | 项目项是否已打开？ |
| 种类 | 全局唯一标识符 | 项目的类型。 |
| 名字 | 线 | 项目项的名称。 |
| 目标 | 目标 | 与项目项关联的运行时对象。 |
| 性能 | 收藏品 | 与该项关联的属性。 |
| 获救的 | 布尔代数学体系的 | 自上次打开以来，项目项是否已被修改？ |
| **方法** |
| 删除 | 从解决方案和存储中删除项目。 |
| 展开视图 | 展开解决方案资源管理器视图以显示项目。 |
| 打开 | 打开项目项。 |
| 去除 | 从项目中删除项目并从磁盘中删除。 |
| 救援 | 保存项目项。 |
| 保存为 | 用另一个文件名保存项目项。 |

## 代码操作

这些对象是在源窗口中操作文本的基本工具，使用简单的字符串操作和更复杂的代码模型解析器。参见[第 12 章](12.html#_Chapter_12_)和[第 13 章](13.html#_Chapter_13_)了解一些示例用法。

### 文本文档

| 财产 | 数据类型 | 描述 |
| 端点 | 文本点 | 指文件结尾的一点。 |
| 选择 | 目标 | 当前选定的文本。 |
| 起点 | 文本点 | 指文件开头的一点。 |
| **方法** |
| 清除书签 | 从文本文档中移除所有未命名的书签。 |
| CreateEditPoint | 创建一个点对象来编辑文档中的文本。 |
| 市场行情 | 为文档中所有找到的文本创建未命名的书签。 |
| 替换模式 | 替换整个文档或范围内的模式。 |
| 替换文本 | 用文档进行简单的文本替换。 |

### 编辑点

| 财产 | 数据类型 | 描述 |
| AtEndOfDocument | 布尔代数学体系的 | 该点是否位于文档的末尾？ |
| 雅典脱机 | 布尔代数学体系的 | 对象是否在行尾？ |
| 在开始文档中 | 布尔代数学体系的 | 该点是否位于文档的开头？ |
| AtStartOfLine | 布尔代数学体系的 | 对象是在一行的开始吗？ |
| codeelemont | 目标 | 返回当前位置的代码元素。 |
| 显示列 | 整数 | 包含该点的当前列。 |
| 线条 | 整数 | 文档中的当前行号。 |
| 线长 | 整数 | 当前行中的字符数。 |
| **方法** |
| 变更案例 | 更改所选文本的大小写。 |
| carleft | 将编辑点向左移动指定的字符数。 |
| 查莱特 | 将编辑点向右移动指定的字符数。 |
| ClearBookmark | 清除当前行中任何未命名的书签。 |
| 复制 | 将文本范围复制到剪贴板。 |
| 切口 | 将文本复制到剪贴板并从文档中删除。 |
| 删除 | 从文档中删除文本。 |
| getline | 获取两行之间的文本行。 |
| 获取文本 | 获取文本字符串。 |
| 插入 | 将文本插入文档。 |
| 下行 | 向下移动一行。 |
| 电视节目时间表 | 向上移动一行。 |
| MoveToLineAndOffset | 移动到一个行和字符偏移量。 |
| 粘贴 | 在当前点粘贴剪贴板的内容。 |
| 替换文本 | 用给定文本替换选定文本。 |
| WordLeft | 向左移动指定的字数。 |
| 单词正确 | 向右移动指定的字数。 |

### 代码模型

使用代码模型在[第 13 章](13.html#_Chapter_13_)中讨论。

| 财产 | 数据类型 | 描述 |
| codeelemonts | 收藏品 | 该级别的所有代码元素对象。 |
| iscasesensitive | 布尔代数学体系的 | 当前语言区分大小写吗？ |
| 语言 | 线 | 文件的编码语言。 |
| **方法** |
| AddClass(添加类) | 创建代码类构造。 |
| 附录 | 在代码中创建枚举构造。 |
| 添加功能 | 创建新的功能代码。 |
| 添加界面 | 创建新的接口代码。 |
| 添加命名空间 | 在模块中创建新的命名空间。 |
| 添加变量 | 创建新的变量代码。 |
| IsValidID | 指定的标识符在当前语言中有效吗？ |
| 去除 | 从文件中移除代码元素。 |

### 代码元素

| 财产 | 数据类型 | 描述 |
| 儿童 | 收藏品 | 子代码元素的集合。 |
| 端点 | 文本点 | 文件中此元素的结束位置。 |
| 表 | 线 | 完全限定的代码元素名称。 |
| 信息位置 | 列举型别 | 是项目中的代码元素还是外部的。 |
| IsCodeType | 布尔代数学体系的 | 可以从元素中获取代码类型对象吗？ |
| 种类 | 列举型别 | 代码元素的类型，即类、函数等。 |
| 语言 | 线 | 编写代码元素的语言。 |
| 名字 | 线 | 代码元素的简称。 |
| ProjectItem | ProjectItem | 与代码元素关联的项目项。 |
| 起点 | 文本点 | 文件中代码元素的起始位置。 |