# 第 4 章应用和插件对象

在本章中，我们将快速概述 Visual Studio 为外接程序作者提供的两个主要对象类，以与 IDE 和其他外接程序进行交互。

## 应用对象

**_applicationObject** 变量包含一个 DTE2 对象引用，它提供了允许您与 Visual Studio IDE 交互的属性和方法。这些属性中的许多将在后续章节和示例中探讨。一些更常用的是:

### 主动文件

此属性返回对当前具有焦点的文档的文档对象引用。该对象包含诸如文件名、文档是否已保存、所选文本、正在编辑的文档类型等信息。

### ActiveWindow

此属性返回对当前活动窗口的窗口对象引用。窗口对象包含标题、窗口类型(工具或文档窗口)、大小(宽度和高度)和位置(左侧和顶部)。它还包含对窗口中当前文档的引用。你可以对窗口做一些基本的操作，比如隐藏、移动、关闭等。

### 调试器

此属性返回对调试器对象的引用，这允许您找出当前断点、机器上运行的进程、当前程序和进程等。您还可以移动到各种代码点，计算表达式等。

### 文件

**Documents** 属性是 Visual Studio 中所有当前打开的文档的集合。每个单独的项目都引用集成开发环境中的一个文档。在[第 11 章](11.html#_Chapter_11_)中，我们将处理文档对象及其内容。

### 版

此属性包含一个字符串，指示 Visual Studio 的版本，即专业版、企业版等。例如，如果您的外接程序不应该在某些版本中运行，这可能会很有用。

### 项目操作

此属性提供一个对象类，允许您向当前项目添加新项或现有项。您也可以导航到一个网址，让集成开发环境打开一个浏览器窗口。我们在生成源代码文件时将在[第 15 章](15.html#_Chapter__15)中使用这个对象。

### 局部誓言

此属性返回开发集成开发环境运行的区域设置。您可以使用它为不同的国家和语言定制您的外接程序。

### 主窗口

此属性返回集成开发环境的主父窗口。它包含了所有不同的窗口属性，你可以浏览它的*链接窗口*集合来找到链接到它的不同的其他窗口。

### 模式

**模式**属性指示集成开发环境是处于设计模式(vsIDEModeDesign)还是调试模式(vsIDEModeDebug)。您可能希望在用户调试代码时禁止外接程序运行。

### 溶液

此属性返回对 IDE 中当前打开的解决方案的引用对象。解决方案对象包含解决方案中所有项目的集合、文件名、解决方案的全局设置、是否已保存等。此外，您可以在解决方案中添加和删除文件，迭代项目，将解决方案保存为另一个名称，等等。我们将在[第 8 章](08.html#_Chapter_8_)中探讨解决对象。

### 工具视窗

此属性返回一个对象，该对象使搜索一些常见工具窗口变得更容易，如任务列表、解决方案资源管理器、错误列表等。我们在[第 14 章](14.html#_Chapter_14_)中探索工具窗口。

### 窗户

此属性是当前在 Visual Studio 中打开的窗口的集合。集合中的每个项目都是一个窗口对象，允许您调整窗口大小和移动窗口、更新标题、更改焦点等。我们在[第 10 章](10.html#_Chapter_10_)中详细探讨了窗户系列。

## 添加对象

**_addInInstance** 对象是 AddIn 类的一个实例。在 **onConnection** 方法中， **_addInInst** 参数被传递到您的外接程序，并被分配给私有类变量 **_addInInstance** 。此变量提供特定于此外接程序实例的详细信息。

### 插件属性

下列属性可用于您的外接程序。

### 集合

**集合**属性返回对当前安装在 Visual Studio 中的外接程序对象集合的引用。您可以使用此属性检查外接程序可能具有的任何依赖关系。

### 连通

这是一个布尔值，指示您的外接程序是否在 Visual Studio 中加载和连接。如果尚未连接，您可以通过将此属性设置为 **True** 以编程方式连接您的外接程序，即:

```
    if (_addinInstance.Connected)
    {
       …
           }

```

### 描述

此字符串属性包含显示在外接程序管理器中的描述性文本，有时也显示为工具提示文本。属性是读/写的，因此您可以动态更新外接程序中的标题。

### GUID

该只读字符串包含来自外接程序注册表项的外接程序的 CLSID。

### 名称

此只读字符串属性保存与外接程序关联的命令名。它是传递给 Visual Studio Commands 集合的 **AddNamedCommand** 方法的名称参数。

### 对象

**对象**属性是对包含外接程序实现代码的实际对象实例的引用。您可以使用此属性来访问存储在对象类中的实现外接程序模块所需的任何附加信息。

### ProgID

此只读字符串属性包含外接程序命令的唯一程序名，通常是文件名、类名和命令名，用句点分隔。

### 卫星路径

该只读字符串是包含实现外接程序的代码的 DLL 所在的完整路径名。

## 集会

下列程序集由外接程序模块使用，可以根据需要添加到代码中。请记住，某些功能仅在 Visual Studio 的较高版本中可用，因此只有在您知道外接程序将运行的最低版本时才使用它们。

### Extensibility.dll

出于连接目的，此程序集包含所有版本的 Visual Studio-IDTExtensibility2 和枚举。

### CommandBars.dll

从 VS 2005 开始，Microsoft.VisualStudio.CommandBars.dll 包含了命令栏模型。早期版本使用 Office.dll 的命令栏模型。

### enve . dll

该程序集包含 Visual Studio 的可扩展性模型，用于管理 IDE、解决方案、项目、文件、代码等。以后的版本都是附加的，以提供更多特定于版本的功能:

*   80 (VS 2005、2008、2010)
*   90 (VS 2008，2010)
*   100 (VS 2010)

### vslangproject . dll

这个程序集包含更详细的可扩展性模型，特别是针对 VB.NET 和 C#项目。