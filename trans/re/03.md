# 第三章字符集

正则表达式模式是描述如何查找匹配文本的字符串表达式。最简单的模式就是我们想要匹配的字母或数字。例如，在我们的帮助系统文本中，我们可以通过使用正则表达式模式`7pm.`找到时间，虽然专门搜索 7pm 不是很有用，但它说明了正则表达式的第一条规则。

## 文字字符

Regex 中有许多具有特殊含义的字符，称为元字符，我们将在本章后面探讨如何使用它们。元字符是:

```
      ^ $ . | { } [ ] ( ) * + ? \

```

模式中的所有其他字符都是文本。正则表达式搜索引擎期望在字符串的某个地方找到准确的文字字符。在我们上面的例子中，`7pm`是三个文字字符，并且将只匹配搜索字符串中的精确文本 7pm。请注意，默认情况下，正则表达式区分大小写，因此 7PM 不匹配。虽然我们可以添加一个选项，让 regex 引擎忽略大小写，但是让我们看看一个稍微不同的方法来解决这个问题。

### 方括号[]

我们将介绍第一个元字符，方括号[]。方括号用于提供搜索文本中某个位置的潜在匹配字符列表。因此，要搜索 7pm，不区分大小写，我们可以使用正则表达式模式`7[Pp][Mm]`。这个模式告诉正则表达式找到数字 7，然后是大写或小写的 P，然后是大写或小写的 m。使用这个模式，7pm、7pM、7PM 或 7Pm 都会被找到。但是，[]将只匹配列表中的一个字符，因此 7PPM 不会匹配该模式。

我们还可以调整我们的模式，以找到上午 1 点到 9 点或下午 1 点到 9 点之间的任何时间(我们将在后面的章节中介绍如何获得 10、11 或 12)。我们现在要调整我们的正则表达式模式，找到一个介于 1 和 9 之间的数字，后跟一个大写或小写的 A 或 P，后跟一个大写或小写的字母 m。得到的模式是`[123456789][aApP][Mm]`。该模式将处理从 1 到 9 开始的任何时间，然后是上午或下午(不考虑大小写)。

#### 范围

除了列出括号内所有可能的字符外，您还可以包含一个破折号来指示字符范围。例如，我们可以将时间搜索模式从`[123456789][aApP][Mm]`更改为`[1-9][aApP][Mm].`这种简写符号使正则表达式更容易编写。您也可以组合括号之间的范围。例如，下面的正则表达式会找到一个两位十六进制数`[0-9A-F][0-9A-F]`。如果我们想包含小写字母，我们可以添加`a-f`。

您也可以将范围和字符组合在一起，所以正则表达式`[0-9ABCDEF]`与`[0-9A-F]`相同，以返回单个十六进制数字。

请注意，如果您想在括号中包含破折号(作为文字字符)，那么它必须出现在字符串的开头或结尾。要测试+、-、或数字，可以使用下面的`[-+0-9]`模式，表示接受破折号(文字字符)或加号，或 0 到 9 之间的任何数字。

#### 不可打印的字符

有些字符不能输入正则表达式模式，例如制表符或新的行字符。这些字符被称为字符转义，允许在文本中搜索几乎任何字符。

*   \a -匹配铃声字符。
*   \b -匹配退格(当在括号之间使用时)。
*   \t -匹配制表符。
*   \r -匹配回车符。
*   \n -匹配新行；大多数 Windows 文件使用\r\n 来指示一行的结尾。
*   \f -匹配表单源。
*   \v -匹配垂直选项卡。
*   \xNN -匹配十六进制值 NN 表示的 ASCII 字符。
*   \cX -匹配 ASCII 控制字符，例如\cC 是 Ctrl-C

当\后面跟另一个不是转义字符的字符时，它与该字符匹配，即使该字符在正则表达式中通常有特殊含义。例如，我们将在后面看到，星号在正则表达式模式中有一个特殊的值。但是，\*字符会覆盖特殊值(括号内)，并与星号字符匹配。

其他一些字符没有等效的 ASCII 字符；但是，您可以使用 Unicode 值来搜索这些字符。例如，如果我们在寻找欧元符号€，我们可以使用下面的正则表达式模式`\u20AC.`虽然 JavaScript 和。NET 框架确实支持它。您可以使用以下 Unicode 符号在文本中查找各种货币代码:

*   欧元- `\u20AC`
*   英镑- `\u00A3`
*   日元`-\u00A5`
*   美元符号$ - `\$`或`\u0024`或`\x24`

要找到以上任何一种货币符号，`[\u20AC\u00A3\u00A5\$]`应该可以。请注意,$在正则表达式中是一个元字符，这就是为什么我们用反斜杠字符来转义它。

| ![](../Images/note.png) | 注意:EMCAScript 是 web 客户端语言(如 JavaScript)所基于的脚本语言规范。一个显著的区别是 EMCAScript 在其正则表达式处理规则中不支持 Unicode。 |

#### 否认

在括号内构建字符集时，有时更容易指定要排除的值。这就是方括号中的^元字符允许您做的事情。模式`[aeiou]`会找到所有元音，模式`[^aeiou]`会找到所有辅音(即任何不是元音的东西)。

否定字符适用于方括号内的所有内容。例如，如果你否定`0-9A-F`模式，即`[^0-9A-F]`，你会发现所有不是有效十六进制数的东西。

#### 快捷指令

除了字符范围和列表之外，还有许多快捷元字符可用于一些常见的字符模式。

##### 1.1.1.1.9 数字

`\d`元字符表示查找任意数字，与`[0-9]`相同。你可以用大写的`\D`来求非数字的，和`[^0-9]`一样。

##### 1.1.1.1.10 字母数字(单词字符)

`\w`元字符意味着匹配任何单词字符(任何大写或小写字母、任何数字和下划线)。它与`[a-zA-Z0-9_].`相同`\W`元字符否定这一点，并匹配任何非单词字符(即`[^a-zA-Z0-9_]`)。

##### 1.1.1.1.11 空白

`\s`元字符意味着匹配字符串中的任何空白字符。空格包括回车、换行符、制表符、换行符和空格字符，即`[\r\n\t\f ].``\S`元字符是否定的，匹配任何非空格字符。

快捷元字符可以在方括号外使用，所以`\d`会找到一个数字，而`0-9`(没有括号)会寻找精确的模式 0-9。

#### 圆点

点元字符匹配任何单个字符(除了\n-linefeed)。最初设计 regex 时，它的目标是文本文件中的行，这就是 linefeed 字符不匹配的原因。英寸 NET 中，单行正则表达式选项使点也匹配换行符(\n)。

要真正匹配一个点或句点，您需要用反斜杠对其进行转义。例如，匹配一个有两个小数位的十进制数可能看起来像这样`\d\d\.\d\d`如果你没有转义点，它会匹配，但是没有小数点、两位数、破折号、两位数等的 5 位数字也会匹配。

## 一些例子

当您想要匹配与模式长度相同的字符串时，字符类正则表达式模式会很方便。在下一章中，我们将看到如何匹配不同的长度。让我们回顾几个例子。

### 社会保障号

社会安全号码是一个九位数的号码，分为三个数字，一个破折号，两个数字，另一个破折号，然后是最后四个数字。要将该模式表示为正则表达式，我们可以使用以下内容:`[0-9][0-9][0-9][-][0-9][0-9][-][0-9][0-9][0-9][0-9].`

### ZIP+4 码

邮政编码+4 是美国用来提供非常具体的邮寄地址位置的邮政编码。该模式由五个数字组成，后跟一个破折号或空格，再后跟四个数字。`\d\d\d\d\d[-\s][0-9][0-9][0-9][0-9]`

### 欧元价格

这个例子展示了如何在文本字符串中找到以欧元表示的价格。

`[\u20AC]\d\d\.[0-9][0-9]`

该模式查找欧元符号，后跟两位数、一个小数点和另外两位数。

## 总结

在本章中，我们讨论了文字字符和元字符。文字字符完全匹配，而元字符有特殊的含义。表 4 描述了我们涉及的元字符。

表 4:元字符

| 性格；角色；字母 | 描述 |
| --- | --- |
| `[]` | 提供可能匹配的字符列表 |
| `\a` | 铃字符 |
| `\b` | 退格(当在括号之间时) |
| `\t` | 制表符 |
| `\r` | 回车 |
| `\n` | 换行 |
| `\f` | 换页 |
| `\v` | 垂直标签 |
| `\xNN` | ASCII 字符神经网络 |
| `\cX` | 控制字符 |
| `\uXXX` | Unicode 字符 |
| `^` | 否定括号内的字符 |
| `\d` | 任何一位数 |
| `\D` | 任何非数字 |
| `\w` | 字母数字(单词字符) |
| `\W` | 一个字也没有 |
| `\s` | 空格 |
| `\S` | 非空白空间 |
| `.` | 匹配任何内容(换行除外) |