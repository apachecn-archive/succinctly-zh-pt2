# 第七章学生的 t 分布

## 基本概念

当我们知道总体分布的标准偏差并且总体是正态分布或者样本足够大以至于中心极限定理适用时，使用第 5 章中描述的正态分布的单样本假设检验是很好的。

这种方法的问题是总体的标准差通常是未知的。解决这个问题的一种方法是使用样本的标准偏差 *s* 代替总体的标准偏差σ，采用 t ![](../Images/image153.png)分布。

具有 k 个**自由度的(**学生的** ) **t 分布**具有由公式给出的概率密度函数:**

![](../Images/image154.png)

其中![](../Images/image155.png)为伽玛函数。

t 分布的概率密度函数的整体形状类似于均值为 0、方差为 1 的正态分布的钟形，只是它稍低一些、更宽一些。随着自由度的增加，t 分布接近标准正态分布，事实上，对于 k ≥ 30，这种近似非常接近:

![](../Images/image156.png)

图 31:按自由度划分的 t 分布图

如果![](../Images/image124.png)具有均值μ和标准差σ的正态分布，那么对于大小为 n 的样本，随机变量:

![](../Images/image157.png)

具有 n–1 个自由度的 t 分布。即使![](../Images/image124.png)没有正态分布，只要 n 足够大(根据中心极限定理)，也是如此。

该检验统计量与中心极限定理中的![](../Images/image158.png)相同，总体标准差σ被样本标准差 *s* 代替。有用的是，通常总体的标准偏差是未知的，而样本的标准偏差是已知的。

## Excel 函数

Excel 提供了以下关于 t 分布的函数:

**T.DIST** (x，df，cum) =当 cum =假时，具有 df 自由度的 T 分布在 x 处的概率密度函数值，以及当 cum =真时，在 x 处的相应累积分布函数

**T.INV** (p，df) =值 x，使得 T.DIST(x，df，真)= p，即 T.DIST(x，df，真)的倒数

**T.DIST.RT** (x，df) =具有 df 自由度的 T 分布 x 处的右尾

**T.DIST.2T** (x，df) =在 x 处具有 df 自由度的 T 分布的右尾加上在-x 处的左尾之和，其中 x ≥ 0(当 x <为 0 时，该函数产生误差值

**T.INV.2T** (p，df)= T.DIST.2T(x，df) = p 的值 xsuch，即 T . dist . 2t(x，df)的倒数

这些功能在 Excel 2010 之前不可用。下表列出了如何使用这些函数，以及在 Excel 2010 之前使用的函数 **TDIST** 和 **TINV** 的等效函数:

| 尾巴 | 分配 | 相反的 |
| --- | --- | --- |
| 右尾巴 | T.距离类型(x，df)=如果 x ≥ 0，则 TDIST(x，df，1)= 1-TDIST(-x，df，1)如果 x < 0 | T.INV(1- α，df) = TINV(2* α，df) |
| 左尾巴 | T.距离(x、df、TRUE)= 1-如果 x ≥ 0，则 TDIST(x，df，1)= TDIST(-x，df，1)如果 x < 0 | T.INV( α，df) = -TINV(2* α，df) |
| 双尾的 | T.2T 距离(x，df) = TDIST(x，df，2) | T.INV.2T( α，df) = TINV( α，df) |

表 8: Excel 测试分布函数

## 假设检验

### 单样本测试

如前所述，当总体方差未知时，t 分布提供了一种对均值进行一个样本检验的好方法，前提是总体是正常的或者样本足够大，从而可以应用中心极限定理。

事实证明，t ![](../Images/image153.png)分布即使在总体不正常的情况下也能提供良好的结果，即使在样本很小时也是如此，前提是样本数据关于样本均值合理地对称分布。这可以通过绘制数据图来确定。以下是对称的迹象:

*   方框图相对对称；也就是说，中线在盒子的中心，胡须在每个方向上均匀延伸
*   直方图看起来是对称的
*   平均值大约等于中位数
*   偏斜系数相对较小

**例**:一个减肥计划声称对治疗肥胖有效。为了测试这一说法，12 人被纳入该计划，并记录了两年后每个人体重增加/减少的磅数。这显示在图 32 的 A 列和 B 列中。我们能断定这个计划是有效的吗？

![](../Images/image159.png)

图 32:一个样本测试

B 列中的负值表示受试者体重增加。如果在 95%的显著性水平上有一些体重减轻，我们判断该计划是有效的。我们选择进行双尾测试，因为这个项目有可能导致体重增加而不是减少。因此，我们的零假设是:

h<sub>0</sub>:μ= 0；也就是说，这个方案是没有效果的。

从图 33 中的方框图中，我们看到数据是非常对称的，因此我们使用 t 检验，即使样本很小:

![](../Images/image160.png)

图 33:示例数据的箱线图

图 33 的 E 列包含进行 t 检验所需的所有公式。由于 Excel 只显示这些公式的值，所以我们在 G 列中显示每个公式(以文本格式)，以便您可以看到计算是如何执行的。

因此，其中 R 为 B4:B15，我们看到![](../Images/image140.png) = COUNT(R) = 12，![](../Images/image132.png) = AVERAGE(R) = 5.5， *s* = STDEV(R) = 11.42，标准误差= ![](../Images/image161.png) = 3.30。由此我们可以看出:

![](../Images/image162.png)同![](../Images/image163.png) = 11 个自由度。

由于 p 值= T.DIST.2T(t，df) = T.DIST.2T(1.668，11)= 0.123 > . 05 =α，因此不拒绝零假设。这意味着有 12.3%的概率达到这么高的 t 值，假设零假设为真，由于 12.3%大于 5%，我们不能拒绝零假设。

得出同样的结论是因为:

t-crit = T.INV.2T(α，df) = T.INV.2T(.05，11) = 2.20 > 1，668 = t-obs。

这里我们使用了 T.DIST.2T 和 T.INV.2T，因为我们采用的是双尾测试。

### 测试两个独立样本

#### 假设人口差异相等

我们的目标是在给定两个独立样本的情况下，确定两个总体的均值是否相等，每个总体一个样本。我们首先假设即使未知，总体方差也是相等的。

假设![](../Images/image139.png)和![](../Images/image164.png)分别是大小为![](../Images/image165.png)和![](../Images/image166.png)的两个独立样本的样本均值。也假设![](../Images/image167.png)和![](../Images/image168.png)是两组数据的样本标准差。如果![](../Images/image124.png)和![](../Images/image169.png)正常，或者如果![](../Images/image165.png)和![](../Images/image166.png)足够大，中心极限定理成立，那么统计:

![](../Images/image170.png)

具有带有![](../Images/image171.png)自由度的 t 分布，其中![](../Images/image172.png)是集合方差，由下式定义:

![](../Images/image173.png)

我们可以用统计量 t 来检验两个总体均值相等或等价于![](../Images/image174.png)的零假设。事实证明，即使![](../Images/image175.png)和![](../Images/image169.png)不正常，![](../Images/image165.png)和![](../Images/image166.png)不是特别大，只要这两个样本合理对称，那么这个测试就会产生相当好的结果。

**示例**:一家食品公司想确定他们的花生酱新配方是否比他们的旧配方好吃很多。他们随机选择了 10 个人的两个样本，让第一个样本中的人用现有的配方品尝花生酱，他们让第二个样本中的人用新配方品尝花生酱。然后，他们要求所有 20 个人填写一份问卷，评估他们品尝的花生酱的味道。

根据图 34 中的数据，确定这两种花生酱是否有显著差异。

从图 34 中我们可以看到，新公式的平均得分是 15，而旧公式的平均得分是 11。但是这种差异仅仅是由于随机效应还是有统计学上的显著差异呢？

我们还注意到两个样本的方差分别为 13.3 和 18.8。事实证明，这两个值足够接近，可以满足等方差假设。

![](../Images/image176.jpg)

图 34:样本数据

最后，如果我们绘制两个数据集的方框图，我们会看到两个数据集都相对对称(也就是说，对于每个样本，每个方框中的彩色区域大小大致相等，上下胡须的长度相当相等)。

因此，t 检验的假设得到了满足。为了进行测试，我们使用了 Excel 的 **t-Test:两个样本假设相等方差**数据分析工具，通常可以通过选择**数据>分析|数据分析**来访问该工具。结果如图 35 所示:

| t 检验:假设方差相等的双样本 |
|  |  |  |
|  | *新增* | *旧* |
| 均值 | Fifteen | Eleven point one |
| 差异 | 13.33333 | 18.76667 |
| 观察 | Ten | Ten |
| 集合方差 | Sixteen point zero five |  |
| 假设平均差异 | Zero |  |
| Df | Eighteen |  |
| t 州 | 2.176768 |  |
| P(T<=t)单尾 | 0.021526 |  |
| 临界单尾 | 1.734064 |  |
| P(T<=t)双尾 | 0.043053 |  |
| 临界双尾测试 | 2.100922 |  |

图 35:假设方差相等双样本检验

假设我们正在执行双尾测试，我们看到 p 值= 0.043，小于通常的α值 0.05。因此，我们可以得出结论，两种花生酱配方的平均得分存在显著差异。

#### 假设不相等的人口差异

在前一节中，我们假设两个总体方差相等(或者至少不是非常不相等)。当不满足相等总体方差的假设时(或者当我们没有足够的证据得出这个结论时)，我们可以通过使用稍微不同版本的 t 检验来修改上一节中使用的方法。

假设![](../Images/image139.png)和![](../Images/image164.png)分别是大小为![](../Images/image165.png)和![](../Images/image166.png)的两个独立样本的样本均值。也假设![](../Images/image167.png)和![](../Images/image168.png)是两组数据的样本标准差。如果![](../Images/image124.png)和![](../Images/image169.png)是正态分布，或者如果![](../Images/image165.png)和![](../Images/image166.png)足够大，中心极限定理成立，那么统计量:

![](../Images/image177.png)

具有以下自由度的 t 分布。

![](../Images/image178.png)

**示例**:使用图 36 中的数据重复前面的分析:

![](../Images/image179.jpg)

图 36:修改后的样本数据

这一次，我们看到差异很大(118.3 对 18.8)。

一般来说，即使一个方差高达另一个方差的四倍，等方差假设也会给出好的结果。这个例子明显违反了这个经验法则，所以我们需要使用具有不相等总体方差的 t 检验，即 Excel 的 **t 检验:两样本假设不相等方差**数据分析工具。

输出如图 37 所示:

| t 检验:假设方差不相等的双样本 |
|  |  |  |
|  | *新增* | *旧* |
| 均值 | Eighteen point nine | Eleven point one |
| 差异 | 118.3222 | 18.76667 |
| 观察 | Ten | Ten |
| 假设平均差异 | Zero |  |
| df | Twelve |  |
| t 州 | 2.106655 |  |
| P(T<=t)单尾 | 0.028434 |  |
| 临界单尾 | 1.782288 |  |
| P(T<=t)双尾 | 0.056869 |  |
| 临界双尾测试 | 2.178813 |  |

图 37:假设方差不相等的双样本检验

请注意，自由度已从示例 1 中的 18 个减少到该示例中的 12 个(实际上是 11.78 个，尽管 Excel 将其四舍五入到 12 个)。因为对于双尾检验，p 值= 0.056869 > .05 = α *，*我们不能拒绝两个公式之间没有显著差异的零假设。

如果我们使用等方差测试，我们会得到如图 6 所示的结果。这将导致我们得出不同的结论，因为对于双尾测试，p 值= 0.049441 < .05 = α*，*，因此我们将得出结论，两种配方之间存在显著差异。

| t 检验:假设方差相等的双样本 |
|  |  |  |
|  | *新增* | *旧* |
| 均值 | Eighteen point nine | Eleven point one |
| 差异 | 118.3222 | 18.76667 |
| 观察 | Ten | Ten |
| 集合方差 | 68.54444 |  |
| 假设平均差异 | Zero |  |
| df | Eighteen |  |
| t 州 | 2.106655 |  |
| P(T<=t)单尾 | 0.024721 |  |
| 临界单尾 | 1.734064 |  |
| P(T<=t)双尾 | 0.049441 |  |
| 临界双尾测试 | 2.100922 |  |

图 38:假设方差相等的相同问题

### 测试配对样本

在**配对样本**假设检验中，从总体中选择一个样本，并对样本中的每个元素进行两次测量。每组测量值都被视为一个样本。与迄今为止研究的假设检验不同，这两个样本不是相互独立的。

例如，如果你想确定喝一杯酒或喝一杯啤酒对记忆的影响是相同的还是不同的，一种方法是取 40 个人的样本。然后你让其中一半人喝一杯酒，另一半人喝一杯啤酒。然后，你给这 40 个人每人做一次记忆测试，并比较结果。这是独立样本的方法。

另一种方法是抽取 20 个人的样本，让每个人喝一杯酒，并进行记忆测试。然后让同样的人喝一杯啤酒，再做一次记忆测试。最后，你比较结果。这是配对样本使用的方法。

第二种方法的优点是样本可以更小。此外，由于啤酒和葡萄酒的样本相同，一些外部因素(或**混杂变量**)影响结果的可能性较小。这种方法的问题是，第二次记忆测试的结果可能会更低，仅仅是因为这个人喝了更多的酒。这可以通过充分分离测试来纠正，例如，在用葡萄酒进行测试后的第二天用啤酒进行测试。

人们参加考试的顺序也有可能影响结果(例如，受试者在第一次考试中学习了一些东西，这有助于他们在第二次考试中学习，或者第二次考试可能会带来一定程度的无聊，从而降低分数)。解决这些**顺序效应**的一种方法是让一半的人在第一天喝葡萄酒，在第二天喝啤酒，而对于另一半人来说，顺序是相反的(这被称为**制衡**)。

显然，不是所有的实验都可以使用配对样本设计。例如，如果你在测试男女之间的差异，那么独立样本将是必要的。

**例**:某诊所提供了一个帮助客户减肥的方案，并要求消费者机构调查该方案的有效性。该机构抽取 15 人的样本，在项目开始前对样本中的每个人进行称重，然后在三个月后对每个人进行称重，得出图 39 表格中的结果。确定程序是否有效。

![](../Images/image180.jpg)

图 39:样本数据

如果计划中的人的体重显著减少，该计划就是有效的。让![](../Images/image124.png) =程序启动三个月后体重的减少。无效假设是:

h<sub>0</sub>:![](../Images/image181.png)= 0；也就是说，任何重量上的差异都是由于偶然性(双尾检验)。

本质上，要使用的测试是如前所述的一个样本测试，但是基于程序前的权重减去程序后的权重的差异。由于图 39 的 D 列中的所有值都是正的，我们看到样本中的所有受试者都减轻了体重。但是减少的幅度大吗？

我们可以使用图 39 的 D 列作为单个样本来创建分析(如图 32 所示)。相反，我们将使用 Excel 的 **t-Test:** **配对两样本均值**数据分析工具。我们首先选择**数据>分析|数据分析**。

当出现如图 40 所示的对话框时，需要填写如图所示的数值，点击**确定**:

![](../Images/image182.png)

图 40: T 检验:配对双样本均值对话框

分析的输出如图 41 所示:

| t 检验:两个样本配对的平均值 |  |
|  |  |  |
|  | *在*之前 | *在*之后 |
| 均值 | 207.9333 | One hundred and ninety-seven |
| 差异 | Eight hundred and fifteen point seven eight one | Five hundred and ninety-five |
| 观察 | Fifteen | Fifteen |
| 皮尔逊相关 | 0.98372 |  |
| 假设平均差异 | Zero |  |
| df | Fourteen |  |
| t 州 | 6.6897 |  |
| P(T<=t)单尾 | 5.14E-06 |  |
| 临界单尾 | 1.76131 |  |
| P(T<=t)双尾 | 1.03E-05 |  |
| 临界双尾测试 | 2.144787 |  |

图 41:配对样本 t 检验分析

由于双尾检验的 p 值为 1.03E-05，我们可以得出结论，平均权重之间存在显著差异。由于之后的平均值低于之前的平均重量，我们可以得出结论，重量明显减少。因此，公平地说，该计划是有效的(至少在三个月期间)。

### 使用测试功能

除了最后几节中显示的方法，Excel 还提供了测试函数来执行三种不同类型的两个样本测试。

**T.TEST** (R1、R2、*尾，类型*)= R1 和 R2 两个样本平均值之差的 t-test 值，其中*尾* = 1(单尾)或 2(双尾)且*类型*取值:

1.  样本具有来自同一群体的成对值
2.  样本来自方差相同的群体
3.  样本来自具有不同方差的总体

这三种类型对应于 Excel 数据分析工具:

1.  t 检验:配对的两个样本的平均值
2.  t 检验:假设方差相等的双样本
3.  t 检验:假设方差不相等的双样本

测试功能不适用于 Excel 2010 之前的版本。对于早期版本的 Excel，可以使用 TTEST 函数，它提供了相同的功能。

例如，我们可以使用测试函数重复图 35 中的分析。从图 42 中我们可以看到，来自具有相同方差的总体的两个独立样本的双尾检验的 p 值为 0.043053(单元格 E40)。这与之前发现的结果相同:

![](../Images/image183.png)

图 42:两个独立样本的测试

图 42 还显示了如果我们没有假设相等的方差(单元格 39)时测试的值。如你所见，这两个结果几乎没有区别。

## 置信区间

到目前为止，我们已经对平均值或平均值之间的差异进行了所谓的**点估计。我们现在定义**置信区间**，它提供了一系列可能的值，而不仅仅是单一的测量。我们可以用 t 分布来说明这是如何工作的:**

总体平均值的 1-α置信区间为:

![](../Images/image184.png)

**例**:计算一个样本 t 检验例的 95%置信区间(见图 32):

![](../Images/image185.png)

这产生了总体平均值的 95%置信区间(-1.757，12.757)。由于区间包含假设的平均值 0，我们再次证明了我们不拒绝零假设的决定是正确的。

从 Excel 2010 开始的 Excel 版本提供以下函数来计算 t 分布的置信区间:

**信心。T** (α，s，n) = k，使得(![](../Images/image186.png)–k，![](../Images/image139.png) + k)是总体平均值的 1–α置信区间；也就是自信。T(α，s，n) = ![](../Images/image187.png) ∙标准误差，其中 n =样本量，s =样本标准差。

因此，对于最后一个例子，我们计算置信度。t . . 05，11.422，12) = 7.257，产生 95%的置信区间![](../Images/image188.png)，如前所述。