# 第五章主播

我们在正则表达式中使用简单的字符集和量词可能会遇到的一个问题是，搜索字符串可能会嵌入一个更大的字符串，而我们可能不想这样。例如，如果我们使用`‘com’`搜索一个互联网网址扩展，它也会找到喜剧、漫画、变等。

假设我们从我们的帮助系统中收到了这条消息。

`Hey Suzie,`

`I called March 26th about Internet issues on hulu.com and ebay.com. I can’t connect to either one, so I am missing my favorite sitcoms.` `I also want to sell some of my comic books, but I can’t get on eBay either. Call me at (619) 555-1212.`

`Thanks`

`Tom`

如果我们要求正则表达式引擎找到模式`com`(全局且不区分大小写)，我们可能会得到下面的结果:

`I called March 26th about Internet issues on hulu.com`还有 ebay.com。这两部我都接不上，所以错过了最喜欢的情景喜剧。`I also want to sell some of my com` ic 书，但是我也上不了易贝。

这不是我们所期望的。

## 锚定元字符

锚元字符允许我们根据字符串位置和/或字符串周围的字符来限制什么匹配是可接受的。

### 起止管柱锚

例如， **^** (在方括号外)和 **$** 是具有特殊含义的锚点元字符。

*   ^ -字符串的开头
*   $ -字符串结尾

虽然到目前为止，我们的示例已经处理了搜索更大的字符串，但是正则表达式模式通常可以用来验证单个字符串看起来像我们正在寻找的模式。例如，如果我们设计了一个输入表单，要求输入用户的社会安全号码，我们可以使用`^\d{3}-\d{2}-\d{4}$`模式，不仅确保他们输入的内容看起来像一个有效的 SSN，而且在文本字段中没有输入任何其他内容。

默认情况下，^和$锚指的是字符串中的第一个和最后一个位置；但是，regex 选项多行改变了这种行为，因此^和$锚指的是一行的开头和结尾，而不是整个字符串。

| ![](img/note.png) | 注意:锚点字符不占据字符串中的位置，它们只是向正则表达式引擎指示搜索字符串周围的预期内容。 |

#### 查找最后一个单词

在我们的帮助系统中，消息中的最后一个词很可能是人名，因此我们可以使用下面的正则表达式模式从文本中找到最后一个词，`\w{1,}\s{0,}$`。请注意，该模式要求找到任意长度的最后一个单词`\w{1,}`，后跟任意数量的空白字符。通常，字符串的最后一个字符是换行符，即使在文本中不可见。所以表达式`\w{1,}$`可能看起来有效，但是如果在最后一个单词后面有空格，就不匹配了。

#### 找到第一个单词

查找字符串中的第一个单词更简单，使用模式`^\w{1,}`，即从字符串的开头开始查找任意数量的单词字符。如果将此选项与多行 regex 选项结合使用，您可以找到每行的开头单词。

| ![](img/tip.png) | 提示:regex 的一些味道(包括微软。NET)支持\A 和\Z 锚点，字符串的开头和结尾与多行设置无关。然而，JavaScript 和其他一些正则表达式不支持这些锚。 |

### 单词锚点

另一个非常常见的锚点是`\b`元字符，用于指示单词边界。在我们前面的例子中，如果我们搜索`\bcom\b`而不仅仅是`com`，我们将只在 hulu.com 和 ebay.com 的网站上找到这个网站。你会经常看到这被称为全词搜索。\b 不占用搜索字符串中的字符位置；它仅用于“环视”搜索文本。

单词锚点是字符串中的第一个字符、字符串中的最后一个字符或两个字符之间的字符，其中一个字符是单词字符(`\w`)，下一个字符不是(`\W`)。

锚不需要成对使用；例如，使用模式`\bcom`可以找到对 **com** 的任何引用，无论是单独引用还是在单词的开头引用。所以**。com** 和**漫画**会匹配，但是**情景喜剧**不会。

您可以使用`\B`锚点来查找字符串中的嵌入模式。例如，使用`\Bcom\B`只会在我们的示例文本中找到**情景喜剧**，因为它是 **com** 中唯一具有有效单词字符或任何一方的事件，即使这些单词字符不被认为是找到的结果的一部分。

## 警告

锚点不同于使用其他字符来帮助以微妙的方式隔离单词。参考我们上面的示例文本:

`I called Mar 26th about Internet issues on hulu.com and ebay.com. I can’t connect to either one, so I am missing my favorite sitcoms. I also want to sell some of my comic books, but I can’t get on eBay either.`

如果我们使用模式`\bcom\b`，我们将找到 hulu.com 和 ebay.com 的 com 域名，但是定界字符(开头的点和末尾的空白或点)不是结果的一部分。

如果我们使用`\Wcom\W`模式，我们将找到相同的两个位置，除了这次，点和空格将包含在结果字符串中。虽然这种区别对于搜索来说可能并不重要，但在后面的章节中，当我们试图操作正则表达式引擎返回的值时，这可能会成为一个问题。

## 总结

在本章中，我们介绍了锚定元字符。虽然它们不是搜索字符串的一部分，但它们对于确保您在期望的位置找到结果非常有用。表 9 显示了锚点字符。

表 9:锚点字符

| 性格；角色；字母 | 描述 |
| `^` | 字符串的开头(在[]之外时) |
| `$` | 字符串或行的结尾(取决于选项) |
| `\b` | 单词锚 |
| `\B` | 匹配项周围必须有有效的单词 |